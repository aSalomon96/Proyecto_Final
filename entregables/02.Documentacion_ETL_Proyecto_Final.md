# üìö Pipeline ETL de Datos Financieros

## üìã Descripci√≥n General

Este proyecto implementa un pipeline ETL completo para la recolecci√≥n, transformaci√≥n y carga de datos del mercado financiero (Top 500 empresas del S&P 500) usando **Python** y **PostgreSQL**.

El objetivo es construir una base de datos lista para el an√°lisis de precios hist√≥ricos, fundamentos financieros y c√°lculos de indicadores t√©cnicos junto con niveles de Fibonacci.

---

## üõ†Ô∏è Herramientas y Tecnolog√≠as

- **Python 3.12**
- **Librer√≠as:**
  - pandas
  - numpy
  - yfinance
  - psycopg2
  - tqdm
  - python-dotenv
- **Base de datos:** PostgreSQL
- **IDE:** Visual Studio Code
- **Administrador DB:** DBeaver

---

## üî• Estructura del Pipeline

### 1. Extracci√≥n

- **Scripts:** `ext.py` y `ext_diario.py`
- **Tecnolog√≠a:** `yfinance`, `pandas`
- **Descripci√≥n T√©cnica:**
  - Se extrae la lista de tickers del S&P 500 desde Wikipedia.
  - Se descargan los precios hist√≥ricos y datos fundamentales de cada acci√≥n usando la API de Yahoo Finance.
  - `ext_diario.py` implementa actualizaciones incrementales diarias, evitando redundancia de datos.

---

### 2. Transformaci√≥n

- **Script:** `transform.py`
- **Tecnolog√≠a:** `pandas`, `numpy`
- **Descripci√≥n T√©cnica:**
  - Normalizaci√≥n y limpieza de datasets.
  - C√°lculo de indicadores t√©cnicos (SMA, EMA, RSI, MACD, Bollinger Bands, ATR, OBV).
  - C√°lculo de ranking de capitalizaci√≥n de mercado para las empresas.
  - Reducci√≥n de precisi√≥n a 3 decimales en precios para optimizar el almacenamiento.
  - Estandarizaci√≥n de fechas y columnas.
  -	C√°lculo de se√±ales de compra/venta en resumen_inversion_ready.csv.
  - Calculo de variaciones diarias, semanal, mensual, anual y cada 5 a√±os en precios_variocion.csv

---

### 3. Carga

- **Script:** `load.py`
- **Tecnolog√≠a:** `psycopg2`, `PostgreSQL`
- **Descripci√≥n T√©cnica:**
  - Inserci√≥n inicial y actualizaci√≥n incremental basadas en control de fechas (UPSERT por fecha y ticker).
  - Control de duplicados en hist√≥ricos y t√©cnicos.
  - Optimizaci√≥n con transacciones y cargas por lotes (batch insert).

![alt text](image.png)
---

### 4. Orquestaci√≥n

- **Script:** `main.py`
- **Descripci√≥n T√©cnica:**
  - Ejecuci√≥n secuencial de: actualizaci√≥n diaria ‚Üí transformaci√≥n ‚Üí carga.
  - Totalmente listo para ser agendado v√≠a cron job o similar.

---

## üõ°Ô∏è Reproducibilidad y Eficiencia

### Reproducibilidad
- El pipeline es totalmente reproducible desde cero con los scripts provistos (`ext.py` + `transform.py` + `load.py`).
- No requiere configuraci√≥n manual fuera del archivo `.env` para credenciales de base de datos.

### Eficiencia
- Descarga de datos usando `threads=True` en `yfinance`.
- Carga incremental que solo procesa nuevos registros.
- Reducci√≥n de tama√±o de archivos eliminando decimales innecesarios.
- Git limpio gracias al uso de `.gitignore` para archivos pesados.

---

## üì¶ Datasets Finales

| Dataset                          | Contenido                                                        |
|-----------------------------------|-------------------------------------------------------------------|
| `empresas_ready.csv`              | Informaci√≥n de empresas (ticker, nombre, sector, industria).     |
| `precios_historicos_ready.csv`    | Precios diarios OHLCV.                                            |
| `indicadores_fundamentales_ready.csv` | PER, ROE, EPS growth, Margen Neto, Dividend Yield.         |
| `indicadores_tecnicos_ready.csv`  | SMA, EMA, RSI, MACD, Bollinger Bands, ATR, OBV, Volatilidad.      |
| `precios_variacion_ready`         | Calculo de variaciones diarias, semanal, mensual, anual y cada 5 a√±os |
| `resumen_inversion.csv`           | Decision Final de compra o venta para cada indicador tec y fund  |

---

## üìà Pr√≥ximos Pasos

- An√°lisis EDA sobre ficheros.
- Construcci√≥n de dashboards de an√°lisis financiero en Power BI.
- Desarrollo de modelos predictivos sobre precios hist√≥ricos.
- Detecci√≥n autom√°tica de se√±ales de compra/venta basadas en indicadores.

---

